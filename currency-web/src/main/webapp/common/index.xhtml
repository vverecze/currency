<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:composition template="template.xhtml">
        <ui:define name="head">
            <title>Currency Calculation</title>
        </ui:define>
        <ui:define name="body">
            <h:head>
                <title>Currency Calculator</title>
            </h:head>
            <h:body>
                <div class="jumbotron">
                <div class="container">
                  <h1 class="display-3">Calculate!</h1>
                  <div class="row">
                      <div class="col-12 col-lg-4">
                          <h:form>
                    <h:inputText id="inputNum" value="#{currencyController.inputNum}"></h:inputText>
                    <h:selectOneMenu id="fromCurr" styleClass="form-control" value="#{currencyController.fromCurrency}">
                        <f:selectItem itemValue="USD" itemLabel="USD"/>
                        <f:selectItem itemValue="JPY" itemLabel="JPY"/>
                        <f:selectItem itemValue="BGN" itemLabel="BGN"/>
                        <f:selectItem itemValue="CZK" itemLabel="CZK"/>
                        <f:selectItem itemValue="DKK" itemLabel="DKK"/>
                        <f:selectItem itemValue="GBP" itemLabel="GBP"/>
                        <f:selectItem itemValue="HUF" itemLabel="HUF"/>
                        <f:selectItem itemValue="PLN" itemLabel="PLN"/>
                        <f:selectItem itemValue="RON" itemLabel="RON"/>
                        <f:selectItem itemValue="SEK" itemLabel="SEK"/>
                        <f:selectItem itemValue="CHF" itemLabel="CHF"/>
                        <f:selectItem itemValue="ISK" itemLabel="ISK"/>
                        <f:selectItem itemValue="NOK" itemLabel="NOK"/>
                        <f:selectItem itemValue="HRK" itemLabel="HRK"/>
                        <f:selectItem itemValue="RUB" itemLabel="RUB"/>
                        <f:selectItem itemValue="TRY" itemLabel="TRY"/>
                        <f:selectItem itemValue="AUD" itemLabel="AUD"/>
                        <f:selectItem itemValue="BRL" itemLabel="BRL"/>
                        <f:selectItem itemValue="CAD" itemLabel="CAD"/>
                        <f:selectItem itemValue="CNY" itemLabel="CNY"/>
                        <f:selectItem itemValue="HKD" itemLabel="HKD"/>
                        <f:selectItem itemValue="IDR" itemLabel="IDR"/>
                        <f:selectItem itemValue="ILS" itemLabel="ILS"/>
                        <f:selectItem itemValue="INR" itemLabel="INR"/>
                        <f:selectItem itemValue="KRW" itemLabel="KRW"/>
                        <f:selectItem itemValue="MXN" itemLabel="MXN"/>
                        <f:selectItem itemValue="MYR" itemLabel="MYR"/>
                        <f:selectItem itemValue="NZD" itemLabel="NZD"/>
                        <f:selectItem itemValue="PHP" itemLabel="PHP"/>
                        <f:selectItem itemValue="SGD" itemLabel="SGD"/>
                        <f:selectItem itemValue="THB" itemLabel="THB"/>
                        <f:selectItem itemValue="ZAR" itemLabel="ZAR"/>
                    </h:selectOneMenu>
                    <h:selectOneMenu id="toCurr" styleClass="form-control" value="#{currencyController.toCurrency}">
                        <f:selectItem itemValue="USD" itemLabel="USD"/>
                        <f:selectItem itemValue="JPY" itemLabel="JPY"/>
                        <f:selectItem itemValue="BGN" itemLabel="BGN"/>
                        <f:selectItem itemValue="CZK" itemLabel="CZK"/>
                        <f:selectItem itemValue="DKK" itemLabel="DKK"/>
                        <f:selectItem itemValue="GBP" itemLabel="GBP"/>
                        <f:selectItem itemValue="HUF" itemLabel="HUF"/>
                        <f:selectItem itemValue="PLN" itemLabel="PLN"/>
                        <f:selectItem itemValue="RON" itemLabel="RON"/>
                        <f:selectItem itemValue="SEK" itemLabel="SEK"/>
                        <f:selectItem itemValue="CHF" itemLabel="CHF"/>
                        <f:selectItem itemValue="ISK" itemLabel="ISK"/>
                        <f:selectItem itemValue="NOK" itemLabel="NOK"/>
                        <f:selectItem itemValue="HRK" itemLabel="HRK"/>
                        <f:selectItem itemValue="RUB" itemLabel="RUB"/>
                        <f:selectItem itemValue="TRY" itemLabel="TRY"/>
                        <f:selectItem itemValue="AUD" itemLabel="AUD"/>
                        <f:selectItem itemValue="BRL" itemLabel="BRL"/>
                        <f:selectItem itemValue="CAD" itemLabel="CAD"/>
                        <f:selectItem itemValue="CNY" itemLabel="CNY"/>
                        <f:selectItem itemValue="HKD" itemLabel="HKD"/>
                        <f:selectItem itemValue="IDR" itemLabel="IDR"/>
                        <f:selectItem itemValue="ILS" itemLabel="ILS"/>
                        <f:selectItem itemValue="INR" itemLabel="INR"/>
                        <f:selectItem itemValue="KRW" itemLabel="KRW"/>
                        <f:selectItem itemValue="MXN" itemLabel="MXN"/>
                        <f:selectItem itemValue="MYR" itemLabel="MYR"/>
                        <f:selectItem itemValue="NZD" itemLabel="NZD"/>
                        <f:selectItem itemValue="PHP" itemLabel="PHP"/>
                        <f:selectItem itemValue="SGD" itemLabel="SGD"/>
                        <f:selectItem itemValue="THB" itemLabel="THB"/>
                        <f:selectItem itemValue="ZAR" itemLabel="ZAR"/>
                    </h:selectOneMenu>
                    <h:commandButton value="Calculate!">
                        <f:ajax execute="inputNum fromCurr toCurr" render="outputNum"></f:ajax>
                    </h:commandButton>

                    <h:outputText id="outputNum" value="#{currencyController.calculateCurrency}"></h:outputText>

                </h:form>                        
                          <div>
                              <h:form>
                                  <h:selectOneMenu id="currHistory" styleClass="form-control" value="#{currencyController.currencyForHistory}">
                                    <f:selectItem itemValue="USD" itemLabel="USD"/>
                                    <f:selectItem itemValue="JPY" itemLabel="JPY"/>
                                    <f:selectItem itemValue="BGN" itemLabel="BGN"/>
                                    <f:selectItem itemValue="CZK" itemLabel="CZK"/>
                                    <f:selectItem itemValue="DKK" itemLabel="DKK"/>
                                    <f:selectItem itemValue="GBP" itemLabel="GBP"/>
                                    <f:selectItem itemValue="HUF" itemLabel="HUF"/>
                                    <f:selectItem itemValue="PLN" itemLabel="PLN"/>
                                    <f:selectItem itemValue="RON" itemLabel="RON"/>
                                    <f:selectItem itemValue="SEK" itemLabel="SEK"/>
                                    <f:selectItem itemValue="CHF" itemLabel="CHF"/>
                                    <f:selectItem itemValue="ISK" itemLabel="ISK"/>
                                    <f:selectItem itemValue="NOK" itemLabel="NOK"/>
                                    <f:selectItem itemValue="HRK" itemLabel="HRK"/>
                                    <f:selectItem itemValue="RUB" itemLabel="RUB"/>
                                    <f:selectItem itemValue="TRY" itemLabel="TRY"/>
                                    <f:selectItem itemValue="AUD" itemLabel="AUD"/>
                                    <f:selectItem itemValue="BRL" itemLabel="BRL"/>
                                    <f:selectItem itemValue="CAD" itemLabel="CAD"/>
                                    <f:selectItem itemValue="CNY" itemLabel="CNY"/>
                                    <f:selectItem itemValue="HKD" itemLabel="HKD"/>
                                    <f:selectItem itemValue="IDR" itemLabel="IDR"/>
                                    <f:selectItem itemValue="ILS" itemLabel="ILS"/>
                                    <f:selectItem itemValue="INR" itemLabel="INR"/>
                                    <f:selectItem itemValue="KRW" itemLabel="KRW"/>
                                    <f:selectItem itemValue="MXN" itemLabel="MXN"/>
                                    <f:selectItem itemValue="MYR" itemLabel="MYR"/>
                                    <f:selectItem itemValue="NZD" itemLabel="NZD"/>
                                    <f:selectItem itemValue="PHP" itemLabel="PHP"/>
                                    <f:selectItem itemValue="SGD" itemLabel="SGD"/>
                                    <f:selectItem itemValue="THB" itemLabel="THB"/>
                                    <f:selectItem itemValue="ZAR" itemLabel="ZAR"/>
                                </h:selectOneMenu>
                                <h:commandButton value="Get history!">
                                    <f:ajax execute="currHistory" onevent="updateGraph" render="asd"></f:ajax>
                                </h:commandButton>
                                  <h:outputText styleClass="history-data" id="asd" value="#{currencyController.currencyHistory}"/>
                              </h:form>
                              <div id="history"></div>
                          </div>
                      </div>
                  </div>
                </div>
                </div>
                <script>
                    function updateGraph(data) {
                        if(data.status == 'success') {
                            var graph = new Rickshaw.Graph({
                                    element: document.querySelector("#history"),
                                    width: 500,
                                    height: 200,
                                    renderer: 'line',
                                    series: [{
                                            data: JSON.parse(document.querySelector('.history-data').textContent),
                                            color: '#4682b4',
                                            name: 'rate'
                                    }]
                            });
                            
                            var hoverDetail = new Rickshaw.Graph.HoverDetail( {
                                graph: graph,
                                xFormatter: function(x) { return x },
                                yFormatter: function(y) { return y }
                            } );

                            graph.render();
                        }
                    }
                   
                </script>
            </h:body>
        </ui:define>
    </ui:composition>
</html>

